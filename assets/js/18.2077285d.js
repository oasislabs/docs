(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{364:function(e,t,s){"use strict";s.r(t);var o=s(42),n=Object(o.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("h1",{attrs:{id:"wiping-node-state"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#wiping-node-state"}},[e._v("#")]),e._v(" Wiping Node State")]),e._v(" "),s("p",[e._v("In some cases you might want (or need) to do a full redeploy with clean state\nbefore deploying a new version of the network. This should never actually be\nused during a Mainnet unless there is some serious corruption, but your node\nwill have to spend time catching up to the rest of the network.")]),e._v(" "),s("p",[e._v("The following instructions assume that your "),s("code",[e._v("datadir")]),e._v(" is defined as\n"),s("code",[e._v("/serverdir/node")]),e._v(" in your node's config.")]),e._v(" "),s("h2",{attrs:{id:"state-wipe-and-keep-node-identity"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#state-wipe-and-keep-node-identity"}},[e._v("#")]),e._v(" State Wipe and Keep Node Identity")]),e._v(" "),s("ol",[s("li",[s("p",[e._v("Stop the "),s("code",[e._v("oasis-node")]),e._v(" server process (this will depend on your own deployment\nsetup)")])]),e._v(" "),s("li",[s("p",[e._v("Remove blockchain state using the "),s("code",[e._v("oasis-node unsafe-reset")]),e._v(" command")]),e._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Do a dry run first to see which files will get deleted.")]),e._v("\noasis-node unsafe-reset --datadir"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/serverdir/node --dry_run --log.level info\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("# Delete.")]),e._v("\noasis-node unsafe-reset --datadir /serverdir/node --log.level info\n")])])]),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[e._v("NOTE")]),e._v(" "),s("p",[s("code",[e._v("oasis-node")]),e._v(" is very strict regarding the ownership of the files.\nIf you encounter the following error:")]),e._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("common/Mkdir: path '/serverdir/node' has invalid owner: 1000. Expected owner: 0\n")])])]),s("p",[e._v("you need to run the "),s("code",[e._v("oasis-node")]),e._v(" command as the exact user that owns the\nfiles, e.g.:")]),e._v(" "),s("div",{staticClass:"language-text extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("sudo --user=#1000 -- oasis-node unsafe-reset --datadir=/serverdir/node --dry_run --log.level info\n")])])])])]),e._v(" "),s("li",[s("p",[e._v("Start the oasis-node server process")])])]),e._v(" "),s("h2",{attrs:{id:"full-state-wipe"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#full-state-wipe"}},[e._v("#")]),e._v(" Full State Wipe")]),e._v(" "),s("div",{staticClass:"custom-block danger"},[s("p",{staticClass:"custom-block-title"},[e._v("WARNING")]),e._v(" "),s("p",[e._v("This is likely not what you want to do. This is destructive and might result in\nlosing private state required to operate the given node. "),s("strong",[e._v("USE AT YOUR OWN\nRISK.")])])]),e._v(" "),s("p",[e._v("A full state wipe will also mean that you'll need to generate a new node\nidentity (or copy the old one).")]),e._v(" "),s("ol",[s("li",[e._v("Stop the "),s("code",[e._v("oasis-node")]),e._v(" server process (this will depend on your own deployment\nsetup)")]),e._v(" "),s("li",[e._v("Remove the the "),s("code",[e._v("/serverdir/node")]),e._v(" directory.")]),e._v(" "),s("li",[e._v("Redeploy your node. You'll need to copy your Node artifacts or create brand\nnew ones.")])])])}),[],!1,null,null,null);t.default=n.exports}}]);