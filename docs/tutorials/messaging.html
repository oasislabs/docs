<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Creating a Private Chat Server | Documentation</title>
    <meta name="description" content="Oasis Developer Documentation">
    <link rel="icon" href="/favicon.ico">
    
    <link rel="preload" href="/assets/css/0.styles.33e8af62.css" as="style"><link rel="preload" href="/assets/js/app.1b98c4bd.js" as="script"><link rel="preload" href="/assets/js/2.8821630d.js" as="script"><link rel="preload" href="/assets/js/9.8c7a4bb7.js" as="script"><link rel="prefetch" href="/assets/js/10.4063fb1d.js"><link rel="prefetch" href="/assets/js/3.bdd0c463.js"><link rel="prefetch" href="/assets/js/4.f8ec84ec.js"><link rel="prefetch" href="/assets/js/5.e67d1ffe.js"><link rel="prefetch" href="/assets/js/6.e064b531.js"><link rel="prefetch" href="/assets/js/7.84e7b10b.js"><link rel="prefetch" href="/assets/js/8.c6e44e61.js">
    <link rel="stylesheet" href="/assets/css/0.styles.33e8af62.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="Documentation" class="logo"> <span class="site-name can-hide">Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://oasislabs.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://dashboard.oasiscloud.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dashboard
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/oasislabs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://oasislabs.com" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Home
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://dashboard.oasiscloud.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dashboard
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <a href="https://github.com/oasislabs" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><a href="/overview.html" class="sidebar-link">Overview</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/overview.html#what-is-oasis" class="sidebar-link">What is Oasis?</a></li><li class="sidebar-sub-header"><a href="/overview.html#cloud-computing-with-blockchain" class="sidebar-link">Cloud Computing with Blockchain</a></li><li class="sidebar-sub-header"><a href="/overview.html#key-features" class="sidebar-link">Key Features</a></li></ul></li><li><a href="/quickstart.html" class="sidebar-link">Quickstart</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/quickstart.html#set-up-the-oasis-sdk" class="sidebar-link">Set Up the Oasis SDK</a></li><li class="sidebar-sub-header"><a href="/quickstart.html#unit-test-the-hello-world-service-using-cargo" class="sidebar-link">Unit Test the &quot;Hello World&quot; Service Using Cargo</a></li><li class="sidebar-sub-header"><a href="/quickstart.html#integration-test-using-the-local-chain" class="sidebar-link">Integration Test Using the Local Chain</a></li><li class="sidebar-sub-header"><a href="/quickstart.html#integration-test-using-devnet-2-0" class="sidebar-link">Integration Test Using Devnet 2.0</a></li><li class="sidebar-sub-header"><a href="/quickstart.html#where-to-go-from-here" class="sidebar-link">Where to go from here?</a></li></ul></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Tutorials</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/tutorials/ballot.html" class="sidebar-link">Beginner: Secret Ballot</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tutorials/ballot.html#prerequisites" class="sidebar-link">Prerequisites</a></li><li class="sidebar-sub-header"><a href="/tutorials/ballot.html#create-a-new-project" class="sidebar-link">Create a New Project</a></li><li class="sidebar-sub-header"><a href="/tutorials/ballot.html#setting-up-dependencies" class="sidebar-link">Setting up dependencies</a></li><li class="sidebar-sub-header"><a href="/tutorials/ballot.html#defining-the-ballot-service" class="sidebar-link">Defining the Ballot Service</a></li><li class="sidebar-sub-header"><a href="/tutorials/ballot.html#testing" class="sidebar-link">Testing</a></li><li class="sidebar-sub-header"><a href="/tutorials/ballot.html#onward-to-messages-of-victory" class="sidebar-link">Onward to (messages of) victory!</a></li></ul></li><li><a href="/tutorials/messaging.html" class="active sidebar-link">Intermediate: Private Chat</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/tutorials/messaging.html#prerequisites" class="sidebar-link">Prerequisites</a></li><li class="sidebar-sub-header"><a href="/tutorials/messaging.html#optional-and-user-defined-types" class="sidebar-link">Optional and User-Defined Types</a></li><li class="sidebar-sub-header"><a href="/tutorials/messaging.html#events" class="sidebar-link">Events!</a></li><li class="sidebar-sub-header"><a href="/tutorials/messaging.html#you-made-it" class="sidebar-link">You made it!</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="creating-a-private-chat-server"><a href="#creating-a-private-chat-server" aria-hidden="true" class="header-anchor">#</a> Creating a Private Chat Server</h1> <p>In this tutorial we will create a private, uncensorable messaging service.
This tutorial demonstrates intermediate concepts: events and composed types.</p> <h2 id="prerequisites"><a href="#prerequisites" aria-hidden="true" class="header-anchor">#</a> Prerequisites</h2> <p>This tutorial assumes that you're already familiar with the concepts presented in the <a href="../ballot-tutorial">previous tutorial</a>.
As such, this won't be a step-by-step tutorial, but rather more of a sightseeing tour.
The full example can be found at <a href="https://github.com/oasislabs/oasis-rs/tree/master/examples/messaging" target="_blank" rel="noopener noreferrer">https://github.com/oasislabs/oasis-rs/tree/master/examples/messaging<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h2 id="optional-and-user-defined-types"><a href="#optional-and-user-defined-types" aria-hidden="true" class="header-anchor">#</a> Optional and User-Defined Types</h2> <h3 id="optional-types"><a href="#optional-types" aria-hidden="true" class="header-anchor">#</a> Optional types</h3> <p>Any item of state or RPC argument can be made optional by wrapping it in <a href="https://doc.rust-lang.org/std/option/enum.Option.html" target="_blank" rel="noopener noreferrer"><code>Option</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> type.
<code>Option</code> is comparable to <code>null</code>/<code>None</code>/<code>Maybe</code> in other languages.
You will hopefully find this very unsurprising.</p> <p>You'll find the first use of <code>Option</code> in the definition of the <code>MessageBoard</code> service state on <a href="https://github.com/oasislabs/oasis-rs/blob/master/examples/messaging/src/lib.rs#L17" target="_blank" rel="noopener noreferrer">line 17<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>:</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token attribute attr-name">#[derive(Service)]</span>
<span class="token keyword">pub</span> <span class="token keyword">struct</span> MessageBoard <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    bcast_char_limit<span class="token punctuation">:</span> Option<span class="token operator">&lt;</span>u32<span class="token operator">&gt;</span><span class="token punctuation">,</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>and, on <a href="https://github.com/oasislabs/oasis-rs/blob/master/examples/messaging/src/lib.rs#L228" target="_blank" rel="noopener noreferrer">line 228<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, an example of setting the character limit to one: <code>Some(1)</code>.</p> <p>On <a href="https://github.com/oasislabs/oasis-rs/blob/master/examples/messaging/src/lib.rs#L145" target="_blank" rel="noopener noreferrer">line 145<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> a tuple of optional types are observed in the context of an RPC function signature: <code>range: (Option&lt;PostId&gt;, Option&lt;PostId&gt;)</code>.</p> <h3 id="user-defined-types"><a href="#user-defined-types" aria-hidden="true" class="header-anchor">#</a> User-defined types</h3> <p>Any composition of RPC types is an RPC type.
So basically things like <code>HashMap&lt;Vec&lt;(u8, i8)&gt;, Option&lt;String&gt;&gt;</code> and any <code>struct</code> containing things like that.
As a concrete example, on <a href="https://github.com/oasislabs/oasis-rs/blob/master/examples/messaging/src/lib.rs#L48" target="_blank" rel="noopener noreferrer">line 48<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, we define a <code>Message</code> with the fields <code>user: UserId</code> and <code>text: String</code>.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token attribute attr-name">#[derive(Serialize, Deserialize, Clone, Debug, PartialEq)]</span>
<span class="token keyword">pub</span> <span class="token keyword">struct</span> Message <span class="token punctuation">{</span>
    from<span class="token punctuation">:</span> UserId<span class="token punctuation">,</span>
    text<span class="token punctuation">:</span> String<span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>There's no special syntax for this; the new type is just a Rust struct.
Like any struct you can add methods and trait implementations using <code>impl</code> and <code>#[derive(..)]</code>.
Indeed, we derive <code>PartialEq</code> on we <code>Message</code> so that we can <code>assert_eq!</code> in the tests.</p> <p>Then, on <a href="https://github.com/oasislabs/oasis-rs/blob/master/examples/messaging/src/lib.rs#L36" target="_blank" rel="noopener noreferrer">line 36<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> we increase the level of abstraction by creating a <code>Post</code> type that contains a stores a list of comments as <code>Vec&lt;Message&gt;</code>.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">pub</span> <span class="token keyword">struct</span> Post <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
    comments<span class="token punctuation">:</span> Vec<span class="token operator">&lt;</span>Message<span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>And a <code>MessageBoard</code> is simply a collection of <code>Posts</code>.</p> <h2 id="events"><a href="#events" aria-hidden="true" class="header-anchor">#</a> Events!</h2> <p>Whereas RPC methods send data back to the caller, events send data to every client watching the blockchain.</p> <p>Events are a versatile primitive and can be used for beyond the standard &quot;hey something happened!&quot; that one would see in Node.js.
For example, because events are emitted by confidential services running on the Oasis platform, they can be used to notarize their inputs.
Concretely, one could make a validation service that certifies its input by emitting a hash of the data; because the service runs on the Oasis platform, clients can trust the certificate.
Furthermore, confidential services can securely encrypt event data so that it can only be read by a restricted set of recipients.
Enough exposition, though: on to the main event!</p> <h3 id="defining-events"><a href="#defining-events" aria-hidden="true" class="header-anchor">#</a> Defining events</h3> <p>Events are defined similarly to service state in that they're (de)serializable structs that derive a particular trait.
For events, they derive <a href="https://docs.rs/oasis-std/0.1.0/oasis-std/exe/trait.Event.html" target="_blank" rel="noopener noreferrer"><code>Event</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> instead of <code>Service</code>.
Aptly named, yes?</p> <p>The message board helpfully notifies participants of a new post or direct message using the <code>MessagePosted</code> event on <a href="https://github.com/oasislabs/oasis-rs/blob/master/examples/messaging/src/lib.rs#L64" target="_blank" rel="noopener noreferrer">line 64<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (reproduced below).
The <a href="https://github.com/oasislabs/oasis-rs/blob/master/examples/messaging/src/lib.rs#L58-L62" target="_blank" rel="noopener noreferrer">comment above the definition<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> explains how events might be used safely in a confidential context.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token attribute attr-name">#[derive(Serialize, Deserialize, Event)]</span>
<span class="token keyword">pub</span> <span class="token keyword">struct</span> MessagePosted <span class="token punctuation">{</span>
    <span class="token attribute attr-name">#[indexed]</span>
    <span class="token keyword">pub</span> author<span class="token punctuation">:</span> UserId<span class="token punctuation">,</span>
    <span class="token attribute attr-name">#[indexed]</span>
    <span class="token keyword">pub</span> recipient<span class="token punctuation">:</span> Option<span class="token operator">&lt;</span>UserId<span class="token operator">&gt;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The only thing that should give you pause here is the <code>#[indexed]</code> attribute.
The explanation is simple: the contents of a field annotated with <code>#[indexed]</code> will be... wait for it... indexed so that clients watching the blockchain can efficiently find matching events.
Note that currently only three events may be indexed, but this may change in the future.
And, of course, events may contain as much non-indexed data as you want.
All data, indexed and otherwise, is emitted with the event.</p> <h3 id="emitting-events"><a href="#emitting-events" aria-hidden="true" class="header-anchor">#</a> Emitting events</h3> <p>Speaking of emitting events, here's how to do it!
Just construct the event struct and the <code>Event</code> trait provides the rest:</p> <div class="language-rust extra-class"><pre class="language-rust"><code>Event<span class="token punctuation">::</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>MessagePosted <span class="token punctuation">{</span>
    author<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    recipient<span class="token punctuation">:</span> None<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>or, equivalently, as called on the event object itself,</p> <div class="language-rust extra-class"><pre class="language-rust"><code>MessagePosted <span class="token punctuation">{</span>
    author<span class="token punctuation">:</span> ctx<span class="token punctuation">.</span><span class="token function">sender</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    recipient<span class="token punctuation">:</span> None<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>Hopefully you found that exposition of events eventful!<br>
Bonus joke: What's a blockchain developer's favorite event? A block party! Ha ha</p> <p>&quot;Ugh, get this over with already,&quot; you think to yourself.</p> <h2 id="you-made-it"><a href="#you-made-it" aria-hidden="true" class="header-anchor">#</a> You made it!</h2> <p>Congratulations on completing the second tutorial!
You should now feel confident that you can confidentially discuss your dinner ballot choices, trash talk other sportsball teams, and keep up with your community of fellow Rust enthusiasts.</p> <p>Well, that's basically all there is to writing blockchain services.
The only other thing to mention is that there's a wealth of libraries for you to use on <a href="https://crates.io" target="_blank" rel="noopener noreferrer">crates.io<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>, the Cargo registry (c.f. NPM).
You're now fully equipped to start building on the Oasis platform.
We look forward to seeing what you create!
If you need any help, you can check out the <a href="https://oasis-labs-oasis-client.readthedocs-hosted.com/en/latest/" target="_blank" rel="noopener noreferrer">oasis.js API reference<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> and get support from the <a href="https://gitter.im/Oasis-official/Lobby" target="_blank" rel="noopener noreferrer">community<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/oasislabs/docs/edit/master/tutorials/messaging.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/tutorials/ballot.html" class="prev">
          Beginner: Secret Ballot
        </a></span> <!----></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1b98c4bd.js" defer></script><script src="/assets/js/2.8821630d.js" defer></script><script src="/assets/js/9.8c7a4bb7.js" defer></script>
  </body>
</html>
